<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NEXUS CREW â€¢ Workforce Commander</title>
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Teko:wght@300;400;600;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-dark: #121212;
      --panel-bg: #1e1e1e;
      --neon-green: #00ff88;
      --neon-orange: #ff9d00;
      --neon-blue: #00ccff;
      --danger: #ff4444;
      --text: #ffffff;
      --border: #333;
    }
    
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body { 
      background: var(--bg-dark); 
      color: var(--text); 
      font-family: 'Roboto', sans-serif;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* === HEADER === */
    header {
      height: 70px; border-bottom: 1px solid var(--border);
      display: flex; justify-content: space-between; align-items: center;
      padding: 0 30px; background: #000;
    }
    .brand { font-family: 'Teko', sans-serif; font-size: 2rem; letter-spacing: 2px; color: var(--text); text-transform: uppercase; }
    .brand span { color: var(--neon-orange); }
    
    .stats-bar { display: flex; gap: 30px; }
    .stat-box { text-align: right; }
    .stat-label { font-size: 0.75rem; color: #888; text-transform: uppercase; }
    .stat-val { font-size: 1.2rem; font-weight: bold; font-family: 'Teko'; color: var(--neon-green); }

    /* === MAIN LAYOUT === */
    .main-container {
      display: flex; flex: 1; height: calc(100vh - 70px);
    }

    /* LEFT: WAITING ROOM (The Bench) */
    .waiting-room {
      width: 300px; background: #161616; border-right: 1px solid var(--border);
      display: flex; flex-direction: column;
    }
    .panel-header {
      padding: 20px; background: #252525; border-bottom: 1px solid var(--border);
      display: flex; justify-content: space-between; align-items: center;
    }
    .panel-title { font-weight: bold; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px; }
    .count-badge { background: var(--neon-blue); color: #000; padding: 2px 8px; border-radius: 4px; font-weight: bold; font-size: 0.8rem; }
    
    .worker-list { flex: 1; overflow-y: auto; padding: 15px; }
    
    .worker-card {
      background: var(--panel-bg); border: 1px solid var(--border);
      padding: 15px; margin-bottom: 10px; border-radius: 6px;
      transition: 0.2s; position: relative;
    }
    .worker-card:hover { border-color: var(--neon-blue); transform: translateX(5px); }
    .worker-card.selected { border-color: var(--neon-orange); background: rgba(255, 157, 0, 0.1); }
    
    .w-role { font-size: 0.7rem; color: #888; text-transform: uppercase; margin-bottom: 4px; }
    .w-name { font-weight: bold; font-size: 1rem; }
    .w-rate { position: absolute; top: 15px; right: 15px; color: var(--neon-green); font-size: 0.9rem; font-family: 'Teko'; }

    /* MIDDLE: ACTIVE MISSIONS (The Field) */
    .mission-control {
      flex: 1; padding: 30px; overflow-y: auto;
      background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000 100%);
    }
    .mission-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }

    .mission-card {
      background: rgba(30, 30, 30, 0.8); border: 1px solid var(--border);
      backdrop-filter: blur(10px); border-radius: 8px; padding: 20px;
      display: flex; flex-direction: column;
    }
    .mission-header { display: flex; justify-content: space-between; margin-bottom: 15px; border-bottom: 1px solid #333; padding-bottom: 10px; }
    .m-title { font-weight: bold; color: var(--neon-orange); }
    .m-pay { color: #fff; font-weight: bold; }
    
    .crew-slots { flex: 1; min-height: 100px; border: 2px dashed #444; border-radius: 6px; margin-bottom: 15px; padding: 10px; display: flex; flex-wrap: wrap; gap: 10px; align-content: flex-start; }
    .crew-slots.highlight { border-color: var(--neon-green); background: rgba(0, 255, 136, 0.05); }

    .deployed-badge {
      background: #333; padding: 5px 10px; border-radius: 4px; font-size: 0.8rem; border: 1px solid var(--neon-blue);
      display: flex; align-items: center; gap: 5px; animation: popIn 0.3s ease;
    }
    @keyframes popIn { from{transform:scale(0)} to{transform:scale(1)} }

    .btn-action {
      width: 100%; padding: 12px; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; text-transform: uppercase; letter-spacing: 1px;
    }
    .btn-complete { background: var(--neon-green); color: #000; }
    .btn-complete:hover { background: #00cc6a; }

    /* RIGHT: NEW MISSION FORM */
    .create-panel {
      width: 280px; background: #161616; border-left: 1px solid var(--border);
      padding: 20px;
    }
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; color: #888; margin-bottom: 5px; font-size: 0.8rem; }
    .form-group input, .form-group select { width: 100%; padding: 10px; background: #222; border: 1px solid #444; color: #fff; border-radius: 4px; }
    .btn-create { background: var(--neon-blue); color: #000; width: 100%; padding: 12px; border: none; font-weight: bold; cursor: pointer; }

  </style>
</head>
<body>

  <header>
    <div class="brand"><i class="fas fa-network-wired"></i> Nexus <span>Crew</span></div>
    <div class="stats-bar">
      <div class="stat-box">
        <div class="stat-label">Total Payouts</div>
        <div class="stat-val" id="totalPayout">$0</div>
      </div>
      <div class="stat-box">
        <div class="stat-label">Active Missions</div>
        <div class="stat-val" id="activeMissions">0</div>
      </div>
    </div>
  </header>

  <div class="main-container">
    
    <aside class="waiting-room">
      <div class="panel-header">
        <span class="panel-title">Waiting Room</span>
        <span class="count-badge" id="waitingCount">0</span>
      </div>
      <div class="worker-list" id="waitingList">
        </div>
    </aside>

    <section class="mission-control">
      <h3 style="margin-bottom:20px; color:#666; text-transform:uppercase; letter-spacing:1px;">Active Operations</h3>
      <div class="mission-grid" id="missionGrid">
        </div>
    </section>

    <aside class="create-panel">
      <h3 style="margin-bottom:20px; color:#fff;">Assign New Task</h3>
      <div class="form-group">
        <label>Task Name</label>
        <input type="text" id="taskName" placeholder="e.g. Concrete Pouring">
      </div>
      <div class="form-group">
        <label>Category</label>
        <select id="taskCat">
          <option value="Construction">Construction</option>
          <option value="Event">Event Mgmt</option>
          <option value="Media">Media/Sports</option>
        </select>
      </div>
      <div class="form-group">
        <label>Payout Pool ($)</label>
        <input type="number" id="taskPay" placeholder="500">
      </div>
      <button class="btn-create" onclick="createMission()">Initialize Task</button>
      
      <div style="margin-top:40px; border-top:1px solid #333; padding-top:20px;">
        <h4 style="color:#888; font-size:0.9rem; margin-bottom:10px;">Quick Add Worker</h4>
        <input type="text" id="newWorker" placeholder="Name" style="width:100%; padding:8px; margin-bottom:5px; background:#222; border:1px solid #444; color:#fff;">
        <button onclick="addWorker()" style="width:100%; padding:8px; background:#333; color:#fff; border:1px solid #555; cursor:pointer;">+ To Waiting Room</button>
      </div>
    </aside>

  </div>

  <script>
    // === DATA STORE ===
    let workers = [
      { id: 1, name: "Raju Bhai", role: "Labor Lead", status: "waiting" },
      { id: 2, name: "Siva Tech", role: "Cameraman", status: "waiting" },
      { id: 3, name: "John Doe", role: "Electrician", status: "waiting" },
      { id: 4, name: "Team Alpha", role: "Security", status: "waiting" },
      { id: 5, name: "Sarah K", role: "Coordinator", status: "waiting" }
    ];

    let missions = [
      { id: 101, name: "Site A - Foundation", cat: "Construction", pay: 1200, crew: [] }
    ];

    let totalPayouts = 0;
    let draggedWorkerId = null;

    // === RENDER LOGIC ===
    function render() {
      // 1. Render Waiting Room
      const wList = document.getElementById('waitingList');
      wList.innerHTML = '';
      const waitingWorkers = workers.filter(w => w.status === 'waiting');
      document.getElementById('waitingCount').innerText = waitingWorkers.length;

      waitingWorkers.forEach(w => {
        const div = document.createElement('div');
        div.className = 'worker-card';
        div.draggable = true;
        div.innerHTML = `
          <div class="w-role">${w.role}</div>
          <div class="w-name">${w.name}</div>
          <div class="w-rate">ID: ${w.id}</div>
        `;
        // Drag Events
        div.ondragstart = (e) => {
          draggedWorkerId = w.id;
          div.classList.add('selected');
        };
        div.ondragend = (e) => div.classList.remove('selected');
        
        // Click to Select (Mobile friendly alternative logic could go here)
        div.onclick = () => {
           if(draggedWorkerId === w.id) draggedWorkerId = null; // toggle
           else draggedWorkerId = w.id;
           document.querySelectorAll('.worker-card').forEach(c => c.classList.remove('selected'));
           if(draggedWorkerId) div.classList.add('selected');
        };

        wList.appendChild(div);
      });

      // 2. Render Missions
      const mGrid = document.getElementById('missionGrid');
      mGrid.innerHTML = '';
      document.getElementById('activeMissions').innerText = missions.length;
      document.getElementById('totalPayout').innerText = "$" + totalPayouts.toLocaleString();

      missions.forEach(m => {
        const div = document.createElement('div');
        div.className = 'mission-card';
        
        let crewHTML = '';
        m.crew.forEach(c => {
          crewHTML += `<div class="deployed-badge"><i class="fas fa-user"></i> ${c.name}</div>`;
        });

        div.innerHTML = `
          <div class="mission-header">
            <div>
              <div class="m-title">${m.name}</div>
              <small style="color:#888">${m.cat}</small>
            </div>
            <div class="m-pay">$${m.pay}</div>
          </div>
          <div class="crew-slots" id="slot-${m.id}">
            ${crewHTML.length ? crewHTML : '<span style="color:#444; font-size:0.8rem;">Drag Workers Here</span>'}
          </div>
          <button class="btn-action btn-complete" onclick="completeMission(${m.id})">
            <i class="fas fa-check-circle"></i> Complete & Pay
          </button>
        `;

        // Drop Zone Logic
        const slot = div.querySelector(`#slot-${m.id}`);
        slot.ondragover = (e) => { e.preventDefault(); slot.classList.add('highlight'); };
        slot.ondragleave = (e) => { slot.classList.remove('highlight'); };
        slot.ondrop = (e) => {
          e.preventDefault();
          slot.classList.remove('highlight');
          assignWorker(m.id);
        };
        // Click to assign (if clicked in waiting room)
        slot.onclick = () => {
            if(draggedWorkerId) assignWorker(m.id);
        };

        mGrid.appendChild(div);
      });
    }

    // === ACTIONS ===
    function assignWorker(missionId) {
      if(!draggedWorkerId) return;
      
      const wIndex = workers.findIndex(w => w.id === draggedWorkerId);
      const mIndex = missions.findIndex(m => m.id === missionId);
      
      if(wIndex > -1 && mIndex > -1) {
        workers[wIndex].status = 'deployed';
        missions[mIndex].crew.push(workers[wIndex]);
        draggedWorkerId = null;
        render();
      }
    }

    function completeMission(missionId) {
      const mIndex = missions.findIndex(m => m.id === missionId);
      if(mIndex > -1) {
        const m = missions[mIndex];
        
        // Pay Logic
        if(m.crew.length > 0) {
          totalPayouts += parseInt(m.pay);
          
          // Return crew to waiting room
          m.crew.forEach(c => {
            const w = workers.find(work => work.id === c.id);
            if(w) w.status = 'waiting';
          });
          
          alert(`Mission "${m.name}" Complete! $${m.pay} distributed to ${m.crew.length} workers.`);
          
          // Remove mission
          missions.splice(mIndex, 1);
          render();
        } else {
          alert("No crew assigned to this mission yet!");
        }
      }
    }

    function createMission() {
      const name = document.getElementById('taskName').value;
      const cat = document.getElementById('taskCat').value;
      const pay = document.getElementById('taskPay').value || 0;

      if(name) {
        missions.push({
          id: Date.now(),
          name, cat, pay, crew: []
        });
        document.getElementById('taskName').value = '';
        render();
      }
    }

    function addWorker() {
      const name = document.getElementById('newWorker').value;
      if(name) {
        workers.push({ id: Date.now(), name, role: "General Staff", status: "waiting" });
        document.getElementById('newWorker').value = '';
        render();
      }
    }

    // Init
    render();

  </script>
</body>
</html>